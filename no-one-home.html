<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>No One Home Authorization | Dryer Dudes</title>
  <link rel="stylesheet" href="styles-v2.css" />
</head>

<body>
  <div class="page">

    <header class="site-header">
      <div class="site-header-inner">
        <div class="brand-row">
          <div class="brand">
            <img src="assets/logo.png" alt="Dryer Dudes logo" class="brand-logo">
            <div class="brand-text">
              <div class="brand-name">Dryer Dudes</div>

              <div class="brand-tag">
                $80 Dryer Repair<br>
                <span>Diagnostic &amp; Labor Included</span>
              </div>

              <div class="brand-subtag">Fair, dryer-only repair</div>
            </div>
          </div>
        </div>

        <div class="cta-row">
          <a class="cta-btn" href="/#book">Book Now</a>
        </div>
      </div>
    </header>

    <!-- Tiny layout helper so checkboxes are LEFT of text (not above) -->
    <style>
      .dd-check {
        display: flex;
        align-items: flex-start;
        gap: 10px;
        line-height: 1.35;
      }
      .dd-check input[type="checkbox"] {
        margin-top: 3px;
        transform: translateY(1px);
      }
      .dd-success {
        margin-top: 12px;
        padding: 12px 14px;
        border-radius: 10px;
        border: 1px solid rgba(0,0,0,0.08);
      }
      .dd-success.hide { display: none; }
    </style>

    <section class="panel">
      <h2>No One Home Service Authorization</h2>
      <p class="subtext">
        This option lets your dryer be serviced without waiting at home — while still keeping everything scheduled,
        documented, and transparent.
      </p>

      <div class="card">
        <div class="card-title">How it works</div>
        <div class="card-text">
          Your appointment still happens inside a scheduled service window. The only difference is you don’t need to be present.
        </div>
      </div>

      <div class="card">
        <div class="card-title">$75 Parts Pre-Authorization (Not a Charge)</div>
        <div class="card-text">
          A temporary <b>$75 authorization hold</b> will be placed on your card. This is a <b>pre-authorization</b> that lets the technician
          install parts up to <b>$75</b> without needing to interrupt you for approval.
        </div>
        <ul class="upgrade-bullets">
          <li>This is <b>not</b> a charge</li>
          <li>Only parts actually used are charged</li>
          <li>Unused amounts are never billed</li>
          <li>If parts will exceed $75, we’ll send you an approval link first</li>
        </ul>
      </div>

      <div class="card">
        <div class="card-title">What happens during the visit</div>
        <ul class="upgrade-bullets">
          <li>Your job runs within the scheduled time window</li>
          <li>A full service video is recorded</li>
          <li>The dryer is tested before completion</li>
          <li>The video is sent to you afterward</li>
          <li>Videos are deleted within 60 days</li>
        </ul>
      </div>
    </section>

    <section class="panel">
      <h2>Required permissions</h2>
      <p class="subtext">Please confirm each item below to continue.</p>

      <form id="noOneHomeForm" class="form" novalidate>

        <div class="field">
          <label class="dd-check">
            <input type="checkbox" name="agree_entry" required />
            <span>I authorize a Dryer Dudes technician to enter my home during the scheduled service window.</span>
          </label>
        </div>

        <div class="field">
          <label class="dd-check">
            <input type="checkbox" name="agree_video" required />
            <span>I understand the service will be video recorded and shared with me after the job.</span>
          </label>
        </div>

        <div class="field">
          <label class="dd-check">
            <input type="checkbox" name="agree_video_delete" required />
            <span>I understand the video will be deleted within 60 days.</span>
          </label>
        </div>

        <div class="field">
          <label class="dd-check">
            <input type="checkbox" name="agree_parts_hold" required />
            <span>I authorize Dryer Dudes to install parts up to $75 without additional approval, and I understand only parts used are charged.</span>
          </label>
        </div>

        <div class="field">
          <label class="dd-check">
            <input type="checkbox" name="agree_pets" required />
            <span>I confirm all pets will be secured away from the service area.</span>
          </label>
          <div class="help">This keeps your pets safe and helps the technician work quickly.</div>
        </div>

        <h2 style="margin-top:24px;">Access & appliance details</h2>
        <p class="subtext">These details are what the tech will rely on. Please be specific.</p>

        <div class="field">
          <label>Entry instructions <span class="req">*</span></label>
          <textarea
            name="entry_instructions"
            placeholder="Lockbox location, gate code, key location, parking notes, callbox, etc."
            required
          ></textarea>
        </div>

        <div class="grid-2">
          <div class="field">
            <label>Dryer location <span class="req">*</span></label>
            <input
              type="text"
              name="dryer_location"
              placeholder="Garage, laundry room, second floor, etc."
              required
            />
          </div>

          <div class="field">
            <label>Breaker panel location <span class="recommended">(recommended)</span></label>
            <input
              type="text"
              name="breaker_location"
              placeholder="Hall closet, garage wall, outside panel, etc."
            />
          </div>
        </div>

        <button id="noOneHomeSubmitBtn" type="submit" class="submit-btn">
          Confirm No One Home Authorization
        </button>

        <div id="successMsg" class="dd-success hide">
          ✅ All set — you’ll receive a new text/email shortly with appointment options to choose from.
        </div>

        <div class="help" style="margin-top:10px;">
          Next step: you’ll receive updated scheduling options by text/email.
        </div>
      </form>
    </section>

    <div class="footer">© 2026 Dryer Dudes</div>
  </div>

  <script>
    const form = document.getElementById("noOneHomeForm");
    const btn = document.getElementById("noOneHomeSubmitBtn");
    const successMsg = document.getElementById("successMsg");

    function setBtnLoading(isLoading) {
      btn.disabled = isLoading;
      btn.style.opacity = isLoading ? "0.7" : "1";
      btn.textContent = isLoading ? "Submitting…" : "Confirm No One Home Authorization";
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      successMsg.classList.add("hide");

      // Force browser validation UI even though we used novalidate
      // (This gives you consistent “please fill out this field” behavior)
      const ok = form.checkValidity();
      if (!ok) {
        form.reportValidity();
        return;
      }

      setBtnLoading(true);

      try {
        // TODO next step:
        // - Persist these permissions/details (Supabase)
        // - Trigger sending “new scheduling options” text/email (Twilio / email service)
        // - Redirect or show confirmation screen

        // For now, simulate success:
        await new Promise(r => setTimeout(r, 300));

        successMsg.classList.remove("hide");
        successMsg.scrollIntoView({ behavior: "smooth", block: "center" });
      } catch (err) {
        alert("Something went wrong. Please try again.");
      } finally {
        setBtnLoading(false);
      }
    });
  </script>
</body>
</html>
